[{"E:\\code5200\\mini\\client\\src\\index.js":"1","E:\\code5200\\mini\\client\\src\\App.js":"2","E:\\code5200\\mini\\client\\src\\components\\Footer.jsx":"3","E:\\code5200\\mini\\client\\src\\pages\\Login.jsx":"4","E:\\code5200\\mini\\client\\src\\pages\\Register.jsx":"5","E:\\code5200\\mini\\client\\src\\pages\\Post.jsx":"6","E:\\code5200\\mini\\client\\src\\pages\\Home.jsx":"7","E:\\code5200\\mini\\client\\src\\components\\Navbar.jsx":"8","E:\\code5200\\mini\\client\\src\\components\\Menu.jsx":"9","E:\\code5200\\mini\\client\\src\\context\\authContext.js":"10","E:\\code5200\\mini\\client\\src\\pages\\Single.jsx":"11","E:\\code5200\\mini\\client\\src\\pages\\User.jsx":"12","E:\\code5200\\mini\\client\\src\\pages\\PostUser.jsx":"13","E:\\code5200\\mini\\client\\src\\pages\\Order.jsx":"14","E:\\code5200\\mini\\client\\src\\components\\Bidding.jsx":"15","E:\\code5200\\mini\\client\\src\\pages\\Statistics.jsx":"16","E:\\code5200\\mini\\client\\src\\pages\\AdminLogin.jsx":"17","E:\\code5200\\mini\\client\\src\\pages\\DeleteUser.jsx":"18","E:\\code5200\\mini\\client\\src\\pages\\DeleteProduct.jsx":"19","E:\\code5200\\mini\\client\\src\\components\\AdminNavbar.jsx":"20","E:\\code5200\\mini\\client\\src\\components\\MixedChart.jsx":"21","E:\\code5200\\mini\\client\\src\\pages\\AdminHome.jsx":"22"},{"size":563,"mtime":1700949134924,"results":"23","hashOfConfig":"24"},{"size":2497,"mtime":1700952064989,"results":"25","hashOfConfig":"24"},{"size":370,"mtime":1700950736122,"results":"26","hashOfConfig":"24"},{"size":1445,"mtime":1700949134925,"results":"27","hashOfConfig":"24"},{"size":2063,"mtime":1700396237972,"results":"28","hashOfConfig":"24"},{"size":8765,"mtime":1700992211667,"results":"29","hashOfConfig":"24"},{"size":3758,"mtime":1700536219471,"results":"30","hashOfConfig":"24"},{"size":2404,"mtime":1700981674513,"results":"31","hashOfConfig":"24"},{"size":1271,"mtime":1700543843190,"results":"32","hashOfConfig":"24"},{"size":1246,"mtime":1700949134924,"results":"33","hashOfConfig":"24"},{"size":8601,"mtime":1700715492164,"results":"34","hashOfConfig":"24"},{"size":8836,"mtime":1700982182387,"results":"35","hashOfConfig":"24"},{"size":2980,"mtime":1700393229155,"results":"36","hashOfConfig":"24"},{"size":8487,"mtime":1700888927798,"results":"37","hashOfConfig":"24"},{"size":6354,"mtime":1700721057421,"results":"38","hashOfConfig":"24"},{"size":1618,"mtime":1700949134925,"results":"39","hashOfConfig":"24"},{"size":1368,"mtime":1700981671038,"results":"40","hashOfConfig":"24"},{"size":1673,"mtime":1700949134924,"results":"41","hashOfConfig":"24"},{"size":1697,"mtime":1700949134924,"results":"42","hashOfConfig":"24"},{"size":1375,"mtime":1700981887197,"results":"43","hashOfConfig":"24"},{"size":2302,"mtime":1700949134923,"results":"44","hashOfConfig":"24"},{"size":8345,"mtime":1700991791714,"results":"45","hashOfConfig":"24"},{"filePath":"46","messages":"47","suppressedMessages":"48","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"1evj80o",{"filePath":"49","messages":"50","suppressedMessages":"51","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"52","messages":"53","suppressedMessages":"54","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"55","messages":"56","suppressedMessages":"57","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"58","messages":"59","suppressedMessages":"60","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"61"},{"filePath":"62","messages":"63","suppressedMessages":"64","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"65","messages":"66","suppressedMessages":"67","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"61"},{"filePath":"68","messages":"69","suppressedMessages":"70","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"71","messages":"72","suppressedMessages":"73","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"74","usedDeprecatedRules":"61"},{"filePath":"75","messages":"76","suppressedMessages":"77","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"78","messages":"79","suppressedMessages":"80","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"81","usedDeprecatedRules":"61"},{"filePath":"82","messages":"83","suppressedMessages":"84","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"85","messages":"86","suppressedMessages":"87","errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"88","usedDeprecatedRules":"61"},{"filePath":"89","messages":"90","suppressedMessages":"91","errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"92","usedDeprecatedRules":"61"},{"filePath":"93","messages":"94","suppressedMessages":"95","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"96","usedDeprecatedRules":"61"},{"filePath":"97","messages":"98","suppressedMessages":"99","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"100","messages":"101","suppressedMessages":"102","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"103","messages":"104","suppressedMessages":"105","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"106","messages":"107","suppressedMessages":"108","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"109","messages":"110","suppressedMessages":"111","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"112","messages":"113","suppressedMessages":"114","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"115","messages":"116","suppressedMessages":"117","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"E:\\code5200\\mini\\client\\src\\index.js",[],[],"E:\\code5200\\mini\\client\\src\\App.js",["118"],[],"E:\\code5200\\mini\\client\\src\\components\\Footer.jsx",[],[],"E:\\code5200\\mini\\client\\src\\pages\\Login.jsx",[],[],"E:\\code5200\\mini\\client\\src\\pages\\Register.jsx",[],[],["119","120","121","122","123","124"],"E:\\code5200\\mini\\client\\src\\pages\\Post.jsx",[],[],"E:\\code5200\\mini\\client\\src\\pages\\Home.jsx",[],[],"E:\\code5200\\mini\\client\\src\\components\\Navbar.jsx",[],[],"E:\\code5200\\mini\\client\\src\\components\\Menu.jsx",["125"],[],"import React, { useEffect, useState } from 'react'\nimport img from \"../img/products/wm.png\"\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\n\n\n\nconst Menu = ({cat}) => {\n    // const product_home = [\n    //     {\n    //       id:\"prod202310271000002001\",\n    //       title: \"Washing Machine\",\n    //       desc: \"Top Load Washing Machine\",\n    //       img: img,\n    //     }\n    //   ];\n  const [product_homes,setProduct_homes] = useState([]);\n  console.log(cat);\n\n  useEffect(()=>{\n    const fetchData = async ()=>{\n    try {\n      const res = await axios.get(`http://localhost:8800/api/products/?cat=${cat}`);\n      setProduct_homes(res.data);\n      console.log(res.data);\n    } catch(err){\n      console.log(err);\n    }\n  };\n  fetchData();\n},[cat]);\n\n    return (\n    <div className='menu'>\n        <h1 >Other products</h1>\n        {product_homes.map(product_home=>(\n            <div className='product_home' key ={product_home.product_id}>\n                <img src={product_home.picture} alt=''/>\n                <h2>{product_home.pname}</h2>\n                <Link to = {`/product/${product_home.product_id}`}>\n                <button>Read More</button>\n                </Link>\n            </div>\n        ))}\n    </div>\n  )\n}\nexport default Menu\n","E:\\code5200\\mini\\client\\src\\context\\authContext.js",[],[],"E:\\code5200\\mini\\client\\src\\pages\\Single.jsx",["126"],[],"import React, { useCallback, useContext, useEffect, useState } from 'react'\nimport Edit from \"../img/edit.png\"\nimport Delete from \"../img/delete.png\"\nimport { Link, useLocation, useNavigate } from 'react-router-dom'\nimport Menu from '../components/Menu'\nimport axios from 'axios'\nimport moment from 'moment'\nimport { AuthContext } from '../context/authContext';\nimport Bidding from '../components/Bidding.jsx'\n\nconst Single = () => {\n\n  const [product, setProduct] = useState({});\n  const [timerDuration, setTimerDuration] = useState(0);\n  const location = useLocation();\n  const navigate = useNavigate();\n  const product_id = location.pathname.split(\"/\")[2];\n  const [status, setStatus] = useState('');\n  const { currentUser } = useContext(AuthContext);\n\n\n  const openBidding = async () => {\n    setStatus('Bidding'); // Open bidding immediately\n    // count down trying \n    const endTime = new Date();\n    endTime.setSeconds(endTime.getSeconds() + parseInt(timerDuration));\n    localStorage.setItem('endTime', endTime);\n\n    setCountdown(timerDuration);\n    // ended here\n    // setTimeout(() => {\n    //   setStatus('Ended'); // End bidding after the specified duration\n    // }, timerDuration * 1000); // Convert seconds to milliseconds\n  };\n\n  // change or break this to a use effect just check if it is sold\n  const startBidSession = async () => {\n    try {\n      const before = await axios.get(`http://localhost:8800/api/orders/before/${product_id}`);\n      if (before.data.status === '1') {\n        setStatus('Sold');\n        // get the bid session and find all the bids here\n        return\n      } else {\n        //create bid session\n        await axios.post(`http://localhost:8800/api/orders/`, {\n          user_id: currentUser.user_id,\n          time: timerDuration,\n          productId: product_id\n        });\n\n      }\n    } catch (err) {\n\n    }\n  }\n  //setting status \n  useEffect(() => {\n    const fetchStatus = async () => {\n      try {\n        console.log(\"error here 1\");\n        // 1 for sold 0 for unsold\n        const res1 = await axios.get(`http://localhost:8800/api/orders/before/${product_id}`);\n        console.log(\"status: \", res1.data.status)\n        if (res1.data.status === '1') setStatus('Sold');\n        // if not initialized to unopened\n      } catch (err) {\n        console.log(\"Error fetching data:\", err);\n      }\n    };\n    fetchStatus();\n  }, [product_id]);\n\n  // setting products\n  useEffect(() => {\n    const fetchData = async () => {\n      console.log(\"Fetching data for product ID:\", product_id);\n      try {\n        const res = await axios.get(`http://localhost:8800/api/products/${product_id}`);\n        setProduct(res.data);\n        \n      } catch (err) {\n        console.log(\"Error fetching data:\", err);\n      }\n    };\n    fetchData();\n  }, [product_id]);\n\n\n  const handleDelete = async () => {\n    try {\n      await axios.delete(`http://localhost:8800/api/products/${product_id}`);\n      navigate(\"/\");\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n\n\n  const startBiddingProcess = () => {\n    startBidSession(); // Starting the bid session\n    openBidding();     // Opening the bidding\n  };\n\n\n  const fetchStatusProcessing = useCallback(async () => {\n    \n    if (status !== 'Sold' && status !== 'unopened') {\n      console.log(\"reading status\", status)\n      \n      const response = await axios.get(`http://localhost:8800/api/orders/time/${product_id}`);\n      console.log(\"reading res:\", response.data.endTime);\n      if (!response.data.endTime ){\n        setStatus('unopened');\n        return;\n      }\n      const endTime = new Date(response.data.endTime);\n      const currentTime = new Date();\n      if (endTime > currentTime) {\n        if (status !== 'Bidding')\n        setStatus('Bidding');\n        return;\n      } else if (endTime < currentTime) {\n        // time ended\n        const res = await axios.get(`http://localhost:8800/api/orders/bid_in_session/${product_id}`);\n        if (res.data.bid_status === '1') {\n          setStatus('Sold');\n          await axios.post(`http://localhost:8800/api/orders/update/${product_id}`);\n          return;\n        } else if (res.data.bid_status === '0'){\n          setStatus('Ended With No biders')\n          await axios.delete(`http://localhost:8800/api/orders/${product_id}`);\n        } else {\n          console.log('No return value, check backend logic')\n        }\n    }\n    }\n  },[status,product_id]);\n\n  useEffect(() => {\n    const intervalId = setInterval(() => {\n      fetchStatusProcessing();\n    }, 1000); // Run every second\n  \n    // Cleanup function to clear the interval when the component unmounts\n    return () => clearInterval(intervalId);\n  }, [fetchStatusProcessing]);\n\n  //count down \n  const [countdown, setCountdown] = useState(null);\n  const fetchEndTime = useCallback(async () => {\n    try {\n      const response = await axios.get(`http://localhost:8800/api/orders/time/${product_id}`);\n      const endTime = new Date(response.data.endTime);\n      //console.log(\"end_time:\",endTime);\n      return endTime;\n    } catch (error) {\n      console.error(\"Error fetching end time:\", error);\n      return null;\n    }\n  });\n\n  const calculateRemainingTime = (endTime) => {\n    const remainingTime = Math.floor((endTime.getTime() - new Date().getTime()) / 1000);\n    return remainingTime > 0 ? remainingTime : null;\n  };\n\n  useEffect(() => {\n    if (status !== 'Bidding') {\n      setCountdown(null);\n      return;\n    }\n    let intervalId;\n\n    const initializeCountdown = async () => {\n      const endTime = await fetchEndTime();\n      if (endTime) {\n        const remainingTime = calculateRemainingTime(endTime);\n        setCountdown(remainingTime);\n\n        intervalId = setInterval(() => {\n          const newRemainingTime = calculateRemainingTime(endTime);\n          if (newRemainingTime !== null) {\n            setCountdown(newRemainingTime);\n          } else {\n            clearInterval(intervalId);\n              // Set the status to 'Ended' here\n          }\n        }, 1000);\n      }\n    };\n\n    initializeCountdown();\n\n    return () => clearInterval(intervalId);\n  }, [fetchEndTime,status]);\n  // Render countdown if it's active\n  const renderCountdown = () => {\n    if (countdown !== null) {\n      return <p>Time remaining: {countdown} seconds</p>;\n    }\n    //setStatus('Ended')\n    return null;\n  };\n  // ended here\n  if (!product || !currentUser || !product.user_id || !currentUser.user_id) {\n    return <div>Login to see more...</div>; // or any other appropriate fallback content\n  }\n  // console.log(\"status\", status)\n  return (\n    <div className='single'>\n      <div className=\"content\">\n        <img src={product?.picture} alt='' />\n        <div className='user'>\n          <div className=\"info\">\n            <Link to={`/user/${product?.username}`}>\n              <span>Uploaded by : {product?.username}</span>\n            </Link>\n            <p>Posted {moment(product.create_time).fromNow()}</p>\n            <p>Starting at {product.price} $</p>\n          </div>\n          {currentUser.user_id === product.user_id && (\n\n            <div className='edit'>\n\n              {status !== 'Bidding' && (\n                <div className='edit'>\n                  <Link to={'/upload?edit=2'} state={product}>\n                    <img src={Edit} alt='' />\n                  </Link>\n                  <img onClick={handleDelete} src={Delete} alt='' />\n                </div>\n              )}\n\n              {/* modify this part so that a useeffect would return the status real time\n              and hence this part could check the status to decide showing or not */}\n              {status !== 'Sold' && status !== 'Bidding' && (\n                <>\n                  <input\n                    type=\"number\"\n                    placeholder=\"Enter time in seconds\"\n                    value={timerDuration}\n                    onChange={(e) => setTimerDuration(e.target.value)}\n                  />\n                  <button onClick={startBiddingProcess}>Open Bidding</button>\n                </>\n              )}\n\n            </div>\n          )}\n        </div>\n        <h1>{product.pname}</h1>\n        {product.description}\n        <div className=\"status\">Status: {status} : {renderCountdown()}</div>\n        {/* Bids Table */}\n        {status !== 'unopened' && <Bidding product_id={product?.product_id} indicator={status}\n          user_id={currentUser?.user_id} start_price={product?.price} puser={product?.user_id}\n          time={timerDuration} />}\n      </div>\n      <Menu cat={product.prod_id} />\n      {/* Status Indicator */}\n\n    </div>\n  )\n}\n\nexport default Single;","E:\\code5200\\mini\\client\\src\\pages\\User.jsx",["127"],[],"E:\\code5200\\mini\\client\\src\\pages\\PostUser.jsx",["128","129","130","131"],[],"import axios from 'axios';\r\nimport React, { useContext, useState } from 'react'\r\nimport ReactQuill from 'react-quill';\r\nimport 'react-quill/dist/quill.snow.css'; // this is text editor\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport moment from \"moment\";\r\nimport { AuthContext } from '../context/authContext.js'\r\n\r\nconst PostUser = () => {\r\n    const state = useLocation().state;\r\n    const [nname, setNname] = useState(state?.nickname || \"\");\r\n    const [uname, setUname] = useState(state?.user_name || \"\");\r\n    const [add, setSCode] = useState(state?.add_id || \"\");\r\n    const [address, setAdd] = useState(state?.address_detail || \"\");\r\n    const [pw, setPW] = useState();\r\n    const [email, setEmail] = useState(state?.email || \"\");\r\n    const {currentUser,logout} = useContext(AuthContext);\r\n\r\n    const navigate = useNavigate()\r\n\r\n    const combinedFunction = () => {\r\n        handleClick();\r\n        logout();\r\n        navigate(\"/\");\r\n      };\r\n      \r\n\r\n    const handleClick = async (e) => {\r\n        \r\n        try {\r\n            await axios.put(`http://localhost:8800/api/users/${state.user_id}`, {\r\n                nname,\r\n                uname,\r\n                add,\r\n                address,\r\n                pw,\r\n                email,\r\n                pw\r\n            })\r\n\r\n            //navigate(\"/\")\r\n        } catch (err) {\r\n            console.log(err);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"add\">\r\n            <div className=\"content\">\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder= {nname}\r\n                    onChange={(e) => setUname(e.target.value)}\r\n                    \r\n                />\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder=\"new password\"\r\n                    onChange={(e) => setPW(e.target.value)}\r\n                />\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder={uname}\r\n                    onChange={(e) => setNname(e.target.value)}\r\n                />\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder={address}\r\n                    onChange={(e) => setAdd(e.target.value)}\r\n                />\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder={add}\r\n                    onChange={(e) => setSCode(e.target.value)}\r\n                />\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder={email}\r\n                    onChange={(e) => setEmail(e.target.value)}\r\n                />\r\n            </div>\r\n            <div className=\"menu\">\r\n                <div className=\"item\">\r\n\r\n                    <div className=\"buttons\">\r\n                        <button onClick={combinedFunction}>Logout and Upload</button>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n        </div>\r\n\r\n    );\r\n};\r\n\r\nexport default PostUser;","E:\\code5200\\mini\\client\\src\\pages\\Order.jsx",["132","133","134","135"],[],"import React, { useCallback, useContext, useEffect, useState } from 'react'\r\n\r\nimport { Link, useLocation, useNavigate } from 'react-router-dom'\r\nimport axios from 'axios'\r\n\r\nimport { AuthContext } from '../context/authContext';\r\n\r\nconst Order = () => {\r\n\r\n  const location = useLocation();\r\n  const order_id = location.pathname.split(\"/\")[2];\r\n  const { currentUser } = useContext(AuthContext);\r\n  const [orders, setOrder] = useState(null);\r\n  const [ratings, setRatings] = useState({});\r\n\r\n\r\n  const truncateID = (id) => {\r\n    if (id && id.length > 2) {\r\n      return `${id.substring(0, 2)}***`; // Replace with asterisks\r\n    }\r\n    return id;\r\n  };\r\n\r\n  const handleRatingChange = (orderId, role, newRating) => {\r\n    const ratingKey = `${orderId}_${role}`;\r\n    setRatings(prevRatings => ({\r\n      ...prevRatings,\r\n      [ratingKey]: newRating\r\n    }));\r\n  };\r\n\r\n  const handlePublishRating = async (orderId, role) => {\r\n    const ratingKey = `${orderId}_${role}`;\r\n    const ratingValue = ratings[ratingKey];\r\n\r\n    // Validate the rating value\r\n    if (!ratingValue || ratingValue < 1 || ratingValue > 5) {\r\n      alert('Rating must be between 1 and 5.');\r\n      return;\r\n    }\r\n\r\n    // Prepare the data payload for the POST request\r\n    const data = {\r\n      order_id: orderId,\r\n      [`${role}_rate`]: ratingValue, // Dynamically set the key based on the role\r\n    };\r\n\r\n    try {\r\n      // Send a POST request to the server endpoint\r\n      const response = await axios.post(`http://localhost:8800/api/users/rates`, data);\r\n      console.log(response.data); // Handle the response as needed\r\n      alert('Rating published successfully.');\r\n\r\n      // Optionally, clear the input field after successful publishing\r\n      setRatings(prevRatings => ({\r\n        ...prevRatings,\r\n        [ratingKey]: '' // Clear the input field\r\n      }));\r\n    } catch (error) {\r\n      console.error('Failed to publish rating:', error);\r\n      alert('Failed to publish rating.');\r\n    }\r\n  };\r\n\r\n  const displayRating = (rate, orderId, role, order) => {\r\n    if (rate === -1) {\r\n      const ratingKey = `${orderId}_${role}`;\r\n\r\n      if ((role === 'buyer' && currentUser.user_id === order.buyer_id) ||\r\n        (role === 'seller' && currentUser.user_id === order.seller_id)) {\r\n        return (\r\n          <>\r\n            <input\r\n              type=\"number\"\r\n              min=\"1\"\r\n              max=\"5\"\r\n              value={ratings[ratingKey] || ''}\r\n              onChange={(e) => handleRatingChange(orderId, role, e.target.value)}\r\n              placeholder=\"Rate 1-5\"\r\n            />\r\n            <button onClick={() => handlePublishRating(orderId, role)}>Publish</button>\r\n          </>\r\n        );\r\n      } else {\r\n        return 'Unrated';\r\n      }\r\n    }\r\n    return rate;\r\n  };\r\n\r\n  const handleStatus = async (orderId, actionType) => {\r\n\r\n    try {\r\n      console.log(orderId, actionType);\r\n      const response = axios.post('http://localhost:8800/api/users/update-status', { order_id: orderId, actionType: actionType });\r\n      console.log(response.status);\r\n      if (!response.status) {\r\n        alert(`${actionType} succesfully`)\r\n        window.location.reload();\r\n        // Here you might want to update the state or inform the user of success\r\n      }\r\n    } catch (error) {\r\n      alert('Error occurred while updating status');\r\n      window.location.reload();\r\n    }\r\n  };\r\n\r\n  function updateOrderComments(orderId, comments, role) {\r\n    // Check which comment to update based on the role\r\n    const updatePayload = { order_id: orderId, comment: comments, role: role };\r\n\r\n    // Making an API call with axios to update the comments in the database\r\n    axios.post(`http://localhost:8800/api/users/update-comments`, updatePayload)\r\n      .then(response => {\r\n        console.log('Success:', response.data);\r\n\r\n      })\r\n      .catch(error => {\r\n        alert('Error occurred while updating status');\r\n        window.location.reload();\r\n      });\r\n  }\r\n\r\n  useEffect(() => {\r\n    const fetchOrder = async () => {\r\n      try {\r\n        console.log(\"res\");\r\n        const res = await axios.get(`http://localhost:8800/api/users/order/${order_id}`);\r\n\r\n        setOrder(res.data);\r\n\r\n\r\n      } catch (err) {\r\n        console.error(err);\r\n        // Redirect or handle error\r\n      }\r\n    };\r\n\r\n    fetchOrder();\r\n  }, [order_id]);\r\n\r\n\r\n\r\n  if (!orders || !currentUser?.user_id) {\r\n    return <div>Loading...or have you logged in yet?</div>; // or any other loading indicator\r\n  };\r\n\r\n  let orderStatus = ''; // Declare orderStatus here\r\n\r\n  if (orders[0].buyer_comment !== null && orders[0].buyer_rate !== -1 && orders[0].seller_comment !== null && orders[0].seller_rate !== -1) {\r\n    orderStatus = 'Completed'; // Assign value to orderStatus\r\n  } else {\r\n    orderStatus = 'Incomplete'; // Assign value to orderStatus\r\n  }\r\n\r\n  console.log(orders);\r\n  return (\r\n    <div className=\"order-web\">\r\n      {orders.map((order, index) => (\r\n        (currentUser.user_id === order.buyer_id || currentUser.user_id === order.seller_id) ? (\r\n          <div key={index} className=\"order-card\">\r\n            <div><strong>Order ID:</strong> {order.order_id}</div>\r\n            <div><strong>Order Status:</strong> {orderStatus}</div>\r\n            <div><strong>Bid Session ID:</strong> {order.bid_session_id}</div>\r\n            <div><strong>Final Price:</strong> {order.final_price}</div>\r\n            <div><strong>Buyer ID:</strong> {order.buyer_id}</div>\r\n            <div><strong>Seller ID:</strong> {order.seller_id}</div>\r\n            <div><strong>Buyer Rate:</strong> {displayRating(order.buyer_rate, order.order_id, 'buyer', order)}</div>\r\n            <div><strong>Seller Rate:</strong> {displayRating(order.seller_rate, order.order_id, 'seller', order)}</div>\r\n            <div><strong>Ship Company:</strong> {order.company}</div>\r\n            <div><strong>Ship Status:</strong> {order.ship_status === 0 ? 'Unshipped' : 'Shipped'}</div>\r\n\r\n            {order.ship_status === 0 && currentUser.user_id === order.seller_id && (\r\n              <button onClick={() => { handleStatus(order.order_id, 'ship') }}>\r\n                Ship Hopefully You really shipped\r\n              </button>\r\n\r\n            )}\r\n            <div><strong>Pay Status:</strong> {order.pay_status === 0 ? 'Unpaid' : 'Paid'}</div>\r\n            {order.pay_status === 0 && currentUser.user_id === order.buyer_id && (\r\n              <button onClick={() => { handleStatus(order.order_id, 'pay') }} >\r\n                Pay Hopefully You really paid</button>\r\n            )}\r\n\r\n            <div><strong>Buyer Comments : </strong></div>\r\n\r\n            <div>\r\n              {order.buyer_comment || (\r\n                <form>\r\n                  {currentUser.user_id === order.buyer_id && (\r\n                    <>\r\n                      <input type=\"text\" name=\"buyerComment\" placeholder=\"Add comment\" />\r\n                      <button type=\"button\" onClick={() => {\r\n                        const comment = document.querySelector('[name=\"buyerComment\"]').value;\r\n                        updateOrderComments(order.order_id, comment, 'buyer');\r\n                        alert('Comment uploaded successfully');\r\n                        window.location.reload();\r\n                      }}>Submit</button>\r\n                    </>\r\n                  )}\r\n                </form>\r\n              )}\r\n            </div>\r\n\r\n            <div><strong>Seller Comments : </strong></div>\r\n\r\n            <div>\r\n              {order.seller_comment || (\r\n                <form>\r\n                  {currentUser.user_id === order.seller_id && (\r\n                    <>\r\n                      <input type=\"text\" name=\"sellerComment\" placeholder=\"Add comment\" />\r\n                      <button type=\"button\" onClick={() => {\r\n                        const comment = document.querySelector('[name=\"sellerComment\"]').value;\r\n                        updateOrderComments(order.order_id, comment, 'seller');\r\n                        alert('Comment uploaded successfully');\r\n                        window.location.reload();\r\n                      }}>Submit</button>\r\n                    </>\r\n                  )}\r\n                </form>\r\n              )}\r\n            </div>\r\n\r\n            <div><strong>Product:</strong> {order.pname}</div>\r\n\r\n          </div>\r\n        ) : (\r\n          <div key={index} className=\"order-message\">\r\n            Only your order is visible\r\n          </div>\r\n        )\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Order","E:\\code5200\\mini\\client\\src\\components\\Bidding.jsx",["136"],[],"import axios from 'axios';\r\nimport React, { useCallback, useEffect, useState } from 'react'\r\n\r\n\r\nconst Bidding = ({ product_id, indicator, user_id, start_price, puser, time, onBiddingUpdate }) => {\r\n  // Assuming 'product_id' is an array of objects with bid details\r\n  // For example: [{ bidder: 'User1', amount: 100, date: '2023-01-01' }, ...]\r\n  const [bids, setBids] = useState([]);\r\n  const [bidAmount, setBidAmount] = useState('');\r\n  const [bidStatusMessage, setBidStatusMessage] = useState('');\r\n\r\n\r\n  const handleBidAmountChange = (event) => {\r\n    setBidAmount(event.target.value);\r\n  };\r\n\r\n  const fetchBids = useCallback(async () => {\r\n    try {\r\n      const res = await axios.get(`http://localhost:8800/api/orders/bids/${product_id}`);\r\n      setBids(res.data); // Update the state with the fetched bids\r\n    } catch (err) {\r\n      console.error('Error fetching bids:', err);\r\n    }\r\n  }, [product_id]); // product_id is a dependency\r\n\r\n  const formatBidder = (bidder) => {\r\n    // Check if the bidder string is long enough\r\n    if (bidder && bidder.length > 2) {\r\n      return `${bidder.substring(0, 2)}${'*'.repeat(bidder.length - 2)}`;\r\n    }\r\n    return bidder;\r\n  };\r\n\r\n  const formatCreateTime = (createTime) => {\r\n    // Extracting up to the minute part of the ISO string\r\n    return createTime ? createTime.substring(0, 16) : '';\r\n  };\r\n  useEffect(() => {\r\n    // Fetch bids when the component mounts\r\n    fetchBids();\r\n    // If the indicator is 'Bidding', set up polling to fetch bids every second\r\n    let intervalId;\r\n    if (indicator === 'Bidding') {\r\n      intervalId = setInterval(fetchBids, 1000); // Poll every 1 second\r\n    }\r\n    return () => {\r\n      if (intervalId) {\r\n        clearInterval(intervalId);\r\n      }\r\n    };\r\n  }, [product_id, indicator, fetchBids]);\r\n\r\n  const handleBidClick = async () => {\r\n    try {\r\n      const highestBid = bids.length > 0 ? Math.max(...bids.map(bid => bid.price)) : start_price;\r\n      if (Number(bidAmount) > highestBid) {\r\n        // Handle successful bid logic\r\n        setBidStatusMessage(\"Bid successful!\");\r\n        await axios.post(`http://localhost:8800/api/orders/add`, {\r\n          bidder_id: user_id,\r\n          product_id: product_id,\r\n          bidprice: bidAmount\r\n        })\r\n      } else {\r\n        // Handle unsuccessful bid logic\r\n        setBidStatusMessage(\"Bidding unsuccessful. Bid amount is too low.\");\r\n      }\r\n    } catch (err) {\r\n      // Handle any errors\r\n      console.error(\"Error in bidding process:\", err);\r\n    }\r\n  };\r\n\r\n  const checkOrder = useCallback(async (bids) => {\r\n    try {\r\n      if (bids.length === 0) {\r\n        console.log(\"No bids available\");\r\n        return;\r\n      }\r\n  \r\n      // First GET request to check if order exists\r\n      const res = await axios.get(`http://localhost:8800/api/orders/order/${product_id}`);\r\n      console.log('Order status:', res.data.order_status);\r\n  \r\n      // Proceed only if there is no existing order\r\n      if (res.data.order_status === 'No Order') {\r\n        // Find the highest bid\r\n        const highestBid = bids.reduce((max, bid) => bid.price > max.price ? bid : max, bids[0]);\r\n        console.log('Highest bid:', highestBid);\r\n  \r\n        // Get seller ID\r\n        const sellerResponse = await axios.get(`http://localhost:8800/api/users/userByProduct/${product_id}`);\r\n        console.log('Seller ID:', sellerResponse.data.user_id);\r\n  \r\n        // POST request to create a new order\r\n        const orderResponse = await axios.post(`http://localhost:8800/api/orders/create`, {\r\n          price: highestBid.price,\r\n          buyer_id: highestBid.user_id,\r\n          bid_session_id: highestBid.bid_session_id,\r\n          seller_id: sellerResponse.data.user_id\r\n        });\r\n  \r\n        // Handle the response from order creation\r\n        console.log('Order created:', orderResponse.data);\r\n        // Return or handle the response as needed\r\n      }\r\n    } catch (err) {\r\n      console.error('Error in checkOrder:', err);\r\n      // Handle the error appropriately\r\n    }\r\n  }, [product_id]);\r\n\r\n  useEffect(() => {\r\n    // Check and call createOrder only when product_id changes\r\n    if (indicator === \"Sold\") {\r\n      checkOrder(bids).catch(error => {\r\n        // Handle the error scenario\r\n        console.error('Failed to create order:', error);\r\n      });\r\n    }\r\n  }, [product_id, checkOrder]); \r\n\r\n  return (\r\n    <div style={{ padding: '20px', backgroundColor: '#e6f5f4', borderRadius: '10px', boxShadow: '0 2px 4px rgba(0, 0, 0, 0.1)' }} className=\"bids-table\">\r\n\r\n      <h3>Bids: </h3>\r\n      <table style={{ width: '100%', marginTop: '20px', borderCollapse: 'collapse' }}>\r\n        <thead style={{ backgroundColor: '#007bff', color: 'white' }}>\r\n          <tr>\r\n            <th style={{ padding: '8px 10px', textAlign: 'left' }}>Bidder</th>\r\n            <th style={{ padding: '8px 10px', textAlign: 'left' }}>Amount</th>\r\n            <th style={{ padding: '8px 10px', textAlign: 'left' }}>Date</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {bids.map((bid, index) => (\r\n            <tr key={index}>\r\n              <td style={{ padding: '8px 10px', textAlign: 'left' }}>{formatBidder(bid.user_id)}</td>\r\n              <td style={{ padding: '10px 10px', textAlign: 'left' }}> ${bid.price}</td>\r\n              <td style={{ padding: '10px 10px', textAlign: 'left' }}>{formatCreateTime(bid.create_time)}</td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n      {indicator === 'Bidding' && (\r\n        <div style={{ marginTop: '20px' }}>\r\n\r\n          {\r\n            user_id !== puser && (\r\n              <>\r\n                <input\r\n                  type=\"number\"\r\n                  placeholder=\"Bid amount\"\r\n                  onChange={handleBidAmountChange}\r\n                  style={{ padding: '10px', marginRight: '10px', borderRadius: '5px' }}\r\n                />\r\n                <button\r\n                  onClick={handleBidClick}\r\n                  style={{ padding: '10px 20px', backgroundColor: '#007bff', color: 'white', border: 'none', borderRadius: '5px' }}\r\n                >\r\n                  Place Bid\r\n                </button>\r\n                {bidStatusMessage && <p>{bidStatusMessage}</p>}\r\n              </>\r\n            )\r\n          }\r\n\r\n        </div>\r\n      )}\r\n      {}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Bidding;\r\n","E:\\code5200\\mini\\client\\src\\pages\\Statistics.jsx",[],[],"E:\\code5200\\mini\\client\\src\\pages\\AdminLogin.jsx",["137"],[],"E:\\code5200\\mini\\client\\src\\pages\\DeleteUser.jsx",[],[],"E:\\code5200\\mini\\client\\src\\pages\\DeleteProduct.jsx",[],[],"E:\\code5200\\mini\\client\\src\\components\\AdminNavbar.jsx",[],[],"E:\\code5200\\mini\\client\\src\\components\\MixedChart.jsx",[],[],"E:\\code5200\\mini\\client\\src\\pages\\AdminHome.jsx",[],[],{"ruleId":"138","severity":1,"message":"139","line":13,"column":8,"nodeType":"140","messageId":"141","endLine":13,"endColumn":15},{"ruleId":"142","replacedBy":"143"},{"ruleId":"144","replacedBy":"145"},{"ruleId":"146","replacedBy":"147"},{"ruleId":"148","replacedBy":"149"},{"ruleId":"150","replacedBy":"151"},{"ruleId":"152","replacedBy":"153"},{"ruleId":"138","severity":1,"message":"154","line":2,"column":8,"nodeType":"140","messageId":"141","endLine":2,"endColumn":11},{"ruleId":"155","severity":1,"message":"156","line":152,"column":24,"nodeType":"140","endLine":152,"endColumn":35},{"ruleId":"138","severity":1,"message":"157","line":4,"column":16,"nodeType":"140","messageId":"141","endLine":4,"endColumn":25},{"ruleId":"138","severity":1,"message":"158","line":3,"column":8,"nodeType":"140","messageId":"141","endLine":3,"endColumn":18},{"ruleId":"138","severity":1,"message":"159","line":6,"column":8,"nodeType":"140","messageId":"141","endLine":6,"endColumn":14},{"ruleId":"138","severity":1,"message":"160","line":17,"column":12,"nodeType":"140","messageId":"141","endLine":17,"endColumn":23},{"ruleId":"161","severity":1,"message":"162","line":38,"column":17,"nodeType":"163","messageId":"164","endLine":38,"endColumn":19},{"ruleId":"138","severity":1,"message":"165","line":1,"column":17,"nodeType":"140","messageId":"141","endLine":1,"endColumn":28},{"ruleId":"138","severity":1,"message":"166","line":3,"column":10,"nodeType":"140","messageId":"141","endLine":3,"endColumn":14},{"ruleId":"138","severity":1,"message":"167","line":3,"column":29,"nodeType":"140","messageId":"141","endLine":3,"endColumn":40},{"ruleId":"138","severity":1,"message":"168","line":17,"column":9,"nodeType":"140","messageId":"141","endLine":17,"endColumn":19},{"ruleId":"155","severity":1,"message":"169","line":121,"column":6,"nodeType":"170","endLine":121,"endColumn":30,"suggestions":"171"},{"ruleId":"138","severity":1,"message":"166","line":3,"column":10,"nodeType":"140","messageId":"141","endLine":3,"endColumn":14},"no-unused-vars","'Bidding' is defined but never used.","Identifier","unusedVar","dot-location",[],"new-parens",[],"no-mixed-operators",[],"no-new-object",["172"],"no-whitespace-before-property",[],"rest-spread-spacing",[],"'img' is defined but never used.","react-hooks/exhaustive-deps","React Hook useCallback does nothing when called with only one argument. Did you forget to pass an array of dependencies?","'useParams' is defined but never used.","'ReactQuill' is defined but never used.","'moment' is defined but never used.","'currentUser' is assigned a value but never used.","no-dupe-keys","Duplicate key 'pw'.","ObjectExpression","unexpected","'useCallback' is defined but never used.","'Link' is defined but never used.","'useNavigate' is defined but never used.","'truncateID' is assigned a value but never used.","React Hook useEffect has missing dependencies: 'bids' and 'indicator'. Either include them or remove the dependency array.","ArrayExpression",["173"],"no-object-constructor",{"desc":"174","fix":"175"},"Update the dependencies array to be: [product_id, checkOrder, indicator, bids]",{"range":"176","text":"177"},[4334,4358],"[product_id, checkOrder, indicator, bids]"]